10000 REM ********************** ll routine 29/07/10 ********************
10001 REM           MKII/MKIII/MKIV This Routine Enters Location
10002 REM
10003 REM
10500 REM **************************************************************
10510 REM  History: dd/mm/yy
10520 REM  29/07/10 - Now displays stations in three columns
10540 REM **************************************************************
10005 DATA ll
10010 ZA%=0:T0%=0
10020 GOSUB 12200:REM input location
10030 GOSUB 6200:REM get date right
10040 IO=0:GOSUB 4450:RETURN 
10399 :
12200 REM -12399 input location
12210 PRINT CL$;:LOCATE 4,22:PRINT"CODE";
12215 LOCATE 4,32:PRINT"LOCATION"
12217 LOCATE ,22:PRINT LEFT$(LY$,4);
12218 LOCATE ,32:PRINT LEFT$(LY$,8):PRINT
12219 GOSUB 12350: LL=15:IF LN<15 THEN LL=LN
12220 FOR L=1 TO LL:LOCATE ,2:PRINT L;:LOCATE ,6:INPUT#9,B$,a$,a$,a$:PRINT B$:NEXT
12221 LOCATE 6,32:PRINT"":LL=30:IF LN<30 THEN LL=LN
12225 FOR L=16 TO LL:LOCATE ,21:PRINT L;:LOCATE ,25:INPUT#9,B$,a$,a$,a$:PRINT B$:NEXT
12226 LOCATE 6,32:PRINT"": LL=45:IF LN<45 THEN LL=LN
12227 FOR L=31 TO LL:LOCATE ,41:PRINT L;:LOCATE ,45:INPUT#9,B$,a$,a$,a$:PRINT B$:NEXT
12228 LOCATE 6,32:PRINT""
12229 FOR L=46 TO LN:LOCATE ,58:PRINT L;:LOCATE ,62:INPUT#9,B$,a$,a$,a$:PRINT B$:NEXT
12230 CLOSE 9:PRINT:LOCATE 23,22:PRINT " n  if not coded above":REM location code
12240 LOCATE ,22:GOSUB 2000:PRINT:IF B$="" THEN 12330:REM return if ok
12250 IF B$="n" THEN 12280
12255 IF B$="N" THEN 12280
12260 IF (VB=0) OR (VA>LN) THEN 12210
12270 GOSUB 12350:FOR L=1 TO VB:INPUT# 9,lo$,L1$,L2$,L3$:NEXT:CLOSE 9:GOTO 12310
12280 L%=0:PRINT "Enter location  ";:GOSUB 2000:LO$=LEFT$(B$+SP$,16)
12290 PRINT "Enter latitude  ";:GOSUB 2000:L1$=B$
12300 PRINT "Enter longitude ";:GOSUB 2000:L2$=B$
12305 PRINT "Enter pressure (mb) ";:GOSUB 2000:L3$=B$
12310 LB$=LO$
12315 GOSUB 2550:PZ$=L3$:IF R%<>2 THEN PRINT#4,"obs made at ";LB$
12317 IF R%<>2 THEN PRINT#4," lat= "+L1$+"; long= "+L2$+"; pressure = "+L3$
12320 LA=VAL(L1$):LO=VAL(L2$):PZ%=VAL(L3$):LC$=LO$:IF R%=0 THEN 12210
12330 GOSUB 5200:GOSUB 4482:RETURN 
12350 OPEN "loc.fil" FOR INPUT AS 9:INPUT# 9,LN:RETURN
65529 REM *** proper last line ***
