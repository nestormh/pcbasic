10000 REM ************ as.rtn 02/12/2010 09:50:00 ************ 
55555 REM Please keep line 10000 updated when changes are made. Volodya Savastiouk
10001 REM            MKII/MKIII/MKIV Motor Timing Test
10002 REM
10003 REM
10004 REM **************************************************************
10005 DATA sh
15000 IF Q14%=1 THEN B$="SH test doesn't work with the single board Brewers. Quitting.": GOSUB 3050: PRINT #4, B$: RETURN
15600 REM -15799 motor timing test
15605 GOSUB 9820
15610 PRINT CL$
15620 TL=VAL(DL$)-20: IF TL<50 THEN TL=50
15630 TU=TL+50: IF TU>120 THEN TU=120
15640 DT=2
15670 GOSUB 17500:IF LO%=1 THEN RETURN 
15675 GOSUB 6800
15677 PRINT#4,
15678 PRINT#4,MDD$+" Slit mask motor timing test at ";TIME$;", ";MP$;DA$;", ";YE$
15679 PRINT#4,
15680 PRINT#4,"           Delay             Cal            Dark    Wavelength 1
15681 PRINT#4,
15682 IF Q14%=1 THEN O1$="?MOTOR.MAX.VEL[11]":GOSUB 9450:WS=VA
15685 FOR MI=TL TO TU STEP DT:IF HF%<>0 THEN MI=TU:GOTO 15730
15690 O1$="L,18041,"+STR$(MI):IF Q14%=1 THEN O1$="!MOTOR.MAX.VEL[11]"+STR$(MI)
15695 GOSUB 9450
15700 WL$="0":WU$="2":CZ$="5":GOSUB 9880:GOSUB 9710
15710 GOSUB 9900
15720 PRINT#4,USING "        ########";MI;
15725 FOR I=0 TO 2:PRINT#4,USING "        ########";F(I);:NEXT:PRINT#4,
15730 NEXT:PRINT#4,
15740 IF Q14%=0 THEN O1$="L,18041,"+DL$:GOSUB 9450
15745 IF Q14%=1 THEN O1$="!MOTOR.MAX.VEL[11]"+STR$(WS):GOSUB 9450
15750 GOSUB 9840:RETURN 
15798 :
15799 : 
17000 REM -17099 set up lamp for test
17020 GOSUB 6610:GOSUB 6620:M5$="128":if mdd$="n2" then m5$="320"
17025 GOSUB 6650:GOSUB 9860
17030 GOSUB 6700:TD=TI+1500
17050 LOCATE ,SP:PRINT "4 - Rotate director prism to lamps":GOSUB 9650
17060 T0=TA/3600:GOSUB 8600
17080 PRINT CL$
17090 LOCATE ,SP:PRINT "Waiting until ";H$;" for lamp warmup":GOSUB 6900:RETURN 
17095 O1$="R,1,1,1":GOSUB 9450:RETURN
17098 :
17099 : 
17500 REM -17599 measure standard lamp
17510 IF M9$<>"2" THEN GOSUB 9820:REM lamp on
17515 GOSUB 2450
17520 GOSUB 17020:RETURN 
65529 REM proper last line
